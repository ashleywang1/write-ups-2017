# picoCTF 2017 : bash-loop-40

**Category:** Binary Exploitation
**Points:** 40
**Solves:**
**Description:**

> We found a program that is hiding a flag but requires you to guess the number it is thinking of. Chances are Linux has an easy way to try all the numbers... Go to /problems/f625672abc185c8d615f852c306d877f and try it out!
>
>
>  HINTS
>
> Either use SSH or use the Web Shell to get onto the shell server and navigate to the correct directory. Then do a quick Google search on 'bash loops'. You may need to use grep to filter out the responses as well!


## Write-up

In the problem directory, there are two files: **bashloop** and **flag**. Obviously, **flag** is unreadable, but **bashloop** is executable. Running ```./bashloop``` returns
> What number am I thinking of? It is between 0 and 4096

Running ```./bashloop 1``` returns
> Nope. Pick another number between 0 and 4096

At this point, you'll need a bash script, preferably one with a for loop. For those unfamiliar with bash scripts, google for help, or look up some [tutorials](http://ryanstutorials.net/bash-scripting-tutorial/bash-loops.php) if you have time.

Script debugging tips:
1. You can save the output of a shell script by enclosing the script with backticks, like ```OUTPUT=`./bashloop $i` ```, or ```OUTPUT=$(./bashloop $i)```.
2. ```OUTPUT=`./bashloop $i`;``` can't have spaces next to the ```=``` sign.
3. [The difference between single bracket ```[ if condition ]``` vs double bracket ```[[ if condition ]```](https://stackoverflow.com/questions/13542832/what-is-the-difference-between-single-and-double-square-brackets-in-bash)

Unfortunately, you can't create a file and run it in the web shell, so you also have to modify your script to make it run on one line. Fortunately, you can use semicolons.

SOLUTION:
```for i in {0..4096}; do OUTPUT=$(./bashloop $i); if [[ "$OUTPUT" =~ ^Nope.* ]]; then continue; else echo "$OUTPUT"; break; fi; done;```

RESULT:
> Yay! That's the number! Here be the flag: 9960332950d7db392f97f29dee04f4ee

## Other write-ups and resources

* none yet
